<?xml version="1.0" encoding="UTF-8"?>

<plugin
	id="com.blocks.BDocuments"
	label="Documents"
	version="1.0.0"
	info="Blocks Documents">

	<requirement bundle="com.blocks.Blocks" version="1.0.0" />
	<requirement bundle="com.blocks.BLifecycle" version="1.0.0" />
	<requirement bundle="com.blocks.BUserInterface" version="1.0.0" />

	<extension-point id="documentControllerDelegate" label="Document Controller Delegate" />
	<extension-point id="documentDefaultWindowControllersFactory" label="Document Default Window Controlers Factory" />

	<extension point="com.blocks.BLifecycle.lifecycle">
		<applicationLaunching class="BDocumentController sharedInstance" />
		<applicationMayTerminateNotification class="BDocumentController sharedInstance" />
		<applicationCancledTerminateNotification class="BDocumentController sharedInstance" />
		<applicationWillTerminate class="BDocumentController sharedInstance" />
	</extension>

	<extension point="com.blocks.BLifecycle.lifecycle">
		<applicationDidFinishLaunching class="BDocumentsService sharedInstance" />
	</extension>
	
	<extension point="com.blocks.BUserInterface.menus" processOrder="2">
		<menu id="com.blocks.BUserInterface.menus.main">
			<menuitem title="%Sync" id="documentsService" submenu="com.blocks.BDocuments.menus.main.file.documentsService" location="after:window" />
		</menu>
		
		<menu id="com.blocks.BUserInterface.menus.main.file">
			<menuitem title="%Show Unsaved Changes..." id="showUnsavedChanges" location="group:closeGroup" action="showUnsavedChanges:" />
		</menu>
		
		<menu id="com.blocks.BDocuments.menus.main.file.documentsService">
			<menuitem title="%Open DocumentsService..." id="openDocumentsService" action="openDocumentsService:" target="BDocumentsService sharedInstance" />
			<menuitem title="%Sign In..." id="toggleDocumentsServiceAuthentication" indentationLevel="1" action="toggleDocumentsServiceAuthentication:" target="BDocumentsService sharedInstance" />
			<menuitem title="%Syncronize..." id="sync" indentationLevel="1" action="beginSync:" target="BDocumentsService sharedInstance" keyEquivalent="s" keyEquivalentModifierMask="NSControlKeyMask|NSCommandKeyMask" />
			<menuitem title="%New Document..." id="newDocumentsServiceDocument" indentationLevel="1" action="newDocumentsServiceDocument:" target="BDocumentsService sharedInstance" />
			<separator indentationLevel="1" group="documents" />
		</menu>
		
		<menu id="com.blocks.BDocuments.menus.main.file.documentsService.sharedDocuments">
		</menu>
	</extension>	
</plugin>